<section class="rounded-3xl border border-white/50 bg-white/90 p-6 shadow-xl backdrop-blur">
  <div class="mb-6">
    <h1 class="text-2xl font-semibold text-slate-900">Your meal history</h1>
    <p class="text-sm text-slate-500">A quick look at everything you've logged recently.</p>
  </div>

  <% if @meals.any? %>
    <div class="overflow-x-auto rounded-2xl border border-slate-100">
      <table class="min-w-full divide-y divide-slate-100 text-sm">
        <thead class="bg-slate-50 text-left text-xs font-semibold uppercase tracking-wider text-slate-500">
          <tr>
            <th class="px-4 py-3">Date</th>
            <th class="px-4 py-3">Meal</th>
            <th class="px-4 py-3">Source</th>
            <th class="px-4 py-3">Rating</th>
            <th class="px-4 py-3">Try again in</th>
            <th class="px-4 py-3">Notes</th>
            <th class="px-4 py-3 text-right">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-100 bg-white/60 text-slate-700">
          <% @meals.each do |meal| %>
            <tr>
              <td class="px-4 py-3"><%= meal.ate_on.to_fs(:long) %></td>
              <td class="px-4 py-3 font-semibold text-slate-900"><%= meal.name %></td>
              <td class="px-4 py-3"><%= meal.source.titleize %></td>
              <td class="px-4 py-3">
                <%= rating_stars(meal.rating, size: :sm, show_label: false) %>
              </td>
              <td class="px-4 py-3"><%= meal.retry_in_days.present? ? pluralize(meal.retry_in_days, "day") : "--" %></td>
              <td class="px-4 py-3"><%= meal.notes.presence || "--" %></td>
              <td class="px-4 py-3 text-right">
                <div class="flex items-center justify-end gap-3">
                  <%= link_to edit_meal_path(meal), class: "inline-flex items-center gap-1 rounded-full border border-white/40 bg-white/70 px-3 py-1 text-xs font-semibold text-slate-700 shadow-sm transition hover:-translate-y-0.5 hover:bg-white" do %>
                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4h2" /><path d="M12 2v2" /><path d="m3 21 1.2-4.8a2 2 0 0 1 .55-.95l11-11a2 2 0 0 1 2.83 0l1.17 1.17a2 2 0 0 1 0 2.83l-11 11a2 2 0 0 1-.95.55Z" /><path d="M15 16h6" /></svg>
                    Edit
                  <% end %>

                  <div data-controller="confirm-modal" class="inline">
                    <%= form_with url: meal_path(meal), method: :delete, local: true, data: { confirm_modal_target: "form" }, class: "inline" do |form| %>
                      <button type="button" class="inline-flex items-center gap-1 rounded-full bg-red-600/90 px-3 py-1 text-xs font-semibold text-white shadow transition hover:bg-red-500" data-action="confirm-modal#open">
                        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 6 3 16h12l3-16" /><path d="M5 6h14" /><path d="m10 11 1 9" /><path d="m14 11-1 9" /><path d="m9 6 1-3h4l1 3" /></svg>
                        Delete
                      </button>
                    <% end %>
                    <div class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-950/70 px-4" data-confirm-modal-target="dialog">
                      <div class="w-full max-w-sm rounded-[32px] border border-white/30 bg-white/95 p-6 text-left text-slate-900 shadow-[0_35px_90px_rgba(15,23,42,0.55)]">
                        <p class="text-lg font-semibold">Delete meal?</p>
                        <p class="mt-1 text-sm text-slate-500">This action cannot be undone.</p>
                        <div class="mt-6 flex items-center justify-end gap-3">
                          <button type="button" class="rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 hover:bg-slate-100" data-action="confirm-modal#cancel">Cancel</button>
                          <button type="button" class="rounded-full bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-red-500" data-action="confirm-modal#confirm">Delete</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="text-sm text-slate-500">You haven't logged anything yet. <%= link_to "Start with your latest meal", new_meal_path, class: "font-semibold text-slate-900" %>.</p>
  <% end %>
</section>
